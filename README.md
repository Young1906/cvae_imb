# Conditional VAE & MCMC for imbalance learning
Minority class oversampling using conditional VAE and MCMC

## TLDR

Oversampling


### MCMC

To sample from from class $c_i$ with probability density function $p(X | y = c_i)$, we can utilize Markov Chain Monte Carlo, we need quantity:

$$
\begin{equation}
\begin{aligned}
H & = \frac{p(x | y = c_i)}{p(x_t | y = c_i)} \\ 
    & = \frac{p(x, y)/p(y)}{p(x_t, y)/p(y)} \\
    & = \frac{p(y|x)}{p(y|x_t)} \times \frac{p(x)}{p(x_t)}
\end{aligned}
\end{equation}
$$

The first term $p(y | x)$, we can train a classifier to approximate this quantity. The choice of $d_\theta(.)$ is very flexible, can be `scikit-learn` implementation of `LogisticRegression()` for binary classification problem or a simple fully connected network.

$$
p(y | x) = d_\theta(x)
$$


For the second term, we can just assume x to be  a parametrics distribution such as Multivariate Gaussian. 

$$
x \sim \mathcal{N}(.; \mu, \Sigma)
$$


## Conditional VAE

### F1-score

|               |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|---------------|------------|-----------------|---------|---------|---------|---------|---------|
| balance       |    0.85942 |         0.77089 | 0.84533 | 0.81475 | **0.9355** | **0.94947** | **0.89619** |
| breast-cancer |    0.95122 |         0.875   | 0.93827 | 0.95122 | 0.97619 | 0.96386 | 0.95238 |
| breast-tissue |    0.95253 |         0.67143 | 0.73608 | 0.68254 | **0.71955** | **0.69156** | **0.60072** |
| connectionist |    0.78947 |         0.71429 | 0.8     | 0.81818 | 0.68182 | 0.82051 | 0.8     |
| frogs         |    0.99379 |         0.9763  | 0.98196 | 0.99436 | **0.95598** | **0.99263** | 0.98871 |
| heart_2cl     |    0.91304 |         0.86047 | 0.87912 | 0.84211 | **0.91954** | **0.89655** | **0.92308** |
| ionosphere    |    0.94737 |         0.88172 | 0.96842 | 0.88235 | **0.88889** | **0.9375**  | **0.94737** |
| parkinsons    |    0.94737 |         0.91228 | 0.96552 | 0.88136 | **0.82143** | **0.93333** | **0.92063** |

### Precision

|               |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|---------------|------------|-----------------|---------|---------|---------|---------|---------|
| balance       |    0.85285 |         0.80325 | 0.82973 | 0.82215 | 0.95435 | 0.94853 | 0.89222 |
| breast-cancer |    0.975   |         0.92105 | 0.97436 | 0.975   | 0.97619 | 0.97561 | 0.95238 |
| breast-tissue |    0.96364 |         0.67955 | 0.76591 | 0.69697 | 0.81591 | 0.66818 | 0.59578 |
| connectionist |    0.83333 |         0.68182 | 0.8     | 0.75    | 0.625   | 0.84211 | 0.8     |
| frogs         |    0.99211 |         0.9741  | 0.97865 | 0.99101 | 0.95383 | 0.99432 | 0.98649 |
| heart_2cl     |    0.85714 |         0.86047 | 0.83333 | 0.9697  | 0.90909 | 0.88636 | 0.875   |
| ionosphere    |    0.91837 |         0.87234 | 0.93878 | 0.80357 | 0.83019 | 0.9     | 0.91837 |
| parkinsons    |    0.96429 |         0.92857 | 0.96552 | 0.86667 | 0.85185 | 0.90323 | 0.85294 |

### Recall

|               |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|---------------|------------|-----------------|---------|---------|---------|---------|---------|
| balance       |    0.872   |         0.744   | 0.864   | 0.808   | 0.928   | 0.952   | 0.912   |
| breast-cancer |    0.92857 |         0.83333 | 0.90476 | 0.92857 | 0.97619 | 0.95238 | 0.95238 |
| breast-tissue |    0.95455 |         0.68182 | 0.72727 | 0.68182 | 0.72727 | 0.72727 | 0.63636 |
| connectionist |    0.75    |         0.75    | 0.8     | 0.9     | 0.75    | 0.8     | 0.8     |
| frogs         |    0.99548 |         0.97851 | 0.98529 | 0.99774 | 0.95814 | 0.99095 | 0.99095 |
| heart_2cl     |    0.97674 |         0.86047 | 0.93023 | 0.74419 | 0.93023 | 0.90698 | 0.97674 |
| ionosphere    |    0.97826 |         0.8913  | 1       | 0.97826 | 0.95652 | 0.97826 | 0.97826 |
| parkinsons    |    0.93103 |         0.89655 | 0.96552 | 0.89655 | 0.7931  | 0.96552 | 1       |

## MCMC

### F1 score

|               | catboost          | decision_tree     | gbc               | knn               | lr                | mlp               | svm               |
|---------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|
| balance       | 0.85534 ± 0.01010 | 0.77878 ± 0.01344 | 0.85522 ± 0.00869 | 0.76407 ± 0.02277 | 0.81874 ± 0.02713 | 0.86270 ± 0.02613 | 0.82459 ± 0.02124 |
| breast-cancer | 0.95912 ± 0.00776 | 0.92483 ± 0.01633 | 0.95609 ± 0.00711 | 0.96472 ± 0.00000 | 0.97981 ± 0.00405 | 0.97278 ± 0.00472 | 0.96897 ± 0.00435 |
| breast-tissue | 0.79040 ± 0.04859 | 0.68911 ± 0.07027 | 0.70142 ± 0.05085 | 0.66342 ± 0.02148 | **0.71234 ± 0.06512** | 0.59860 ± 0.06217 | **0.63469 ± 0.05318** |
| connectionist | 0.78764 ± 0.01644 | 0.72634 ± 0.05323 | 0.79243 ± 0.01853 | 0.81272 ± 0.00909 | 0.66846 ± 0.00843 | **0.83991 ± 0.02029** | 0.78333 ± 0.01880 |
| frogs         | 0.99064 ± 0.00091 | 0.96854 ± 0.00444 | 0.97717 ± 0.00200 | 0.99304 ± 0.00000 | **0.94524 ± 0.00232** | 0.98745 ± 0.00194 | 0.98169 ± 0.00087 |
| heart_2cl     | 0.82107 ± 0.02139 | 0.74410 ± 0.05252 | 0.81084 ± 0.04649 | 0.68900 ± 0.00000 | **0.89092 ± 0.03232** | **0.85742 ± 0.04248** | **0.79788 ± 0.08831** |
| ionosphere    | 0.94449 ± 0.01031 | 0.86825 ± 0.03093 | 0.95142 ± 0.00873 | 0.82372 ± 0.00996 | **0.85594 ± 0.01186** | **0.90219 ± 0.01152** | 0.91556 ± 0.00505 |
| parkinsons    | 0.91270 ± 0.02577 | 0.84864 ± 0.03577 | 0.89533 ± 0.03298 | 0.86208 ± 0.00585 | 0.78929 ± 0.02070 | 0.86293 ± 0.02470 | **0.85317 ± 0.00876** |

### Precision

|               | catboost          | decision_tree     | gbc               | knn               | lr                | mlp               | svm               |
|---------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|
| balance       | 0.85048 ± 0.01227 | 0.80887 ± 0.01252 | 0.83717 ± 0.01189 | 0.84035 ± 0.01774 | 0.89089 ± 0.03389 | 0.90199 ± 0.01847 | 0.86760 ± 0.01755 |
| breast-cancer | 0.95966 ± 0.00758 | 0.92566 ± 0.01621 | 0.95713 ± 0.00674 | 0.96518 ± 0.00000 | 0.97983 ± 0.00401 | 0.97285 ± 0.00473 | 0.96902 ± 0.00439 |
| breast-tissue | 0.81126 ± 0.05526 | 0.71117 ± 0.08801 | 0.72665 ± 0.06484 | 0.69018 ± 0.01253 | 0.74354 ± 0.08645 | 0.60262 ± 0.07566 | 0.66122 ± 0.08099 |
| connectionist | 0.78875 ± 0.01734 | 0.74320 ± 0.05750 | 0.79385 ± 0.01846 | 0.81521 ± 0.00827 | 0.67868 ± 0.00700 | 0.84281 ± 0.02219 | 0.78576 ± 0.01775 |
| frogs         | 0.99065 ± 0.00091 | 0.96859 ± 0.00443 | 0.97722 ± 0.00200 | 0.99307 ± 0.00000 | 0.94525 ± 0.00232 | 0.98746 ± 0.00193 | 0.98169 ± 0.00087 |
| heart_2cl     | 0.83945 ± 0.03059 | 0.74168 ± 0.05949 | 0.81908 ± 0.05670 | 0.66435 ± 0.00000 | 0.87540 ± 0.02209 | 0.83726 ± 0.02456 | 0.72622 ± 0.08195 |
| ionosphere    | 0.94881 ± 0.01035 | 0.86930 ± 0.03075 | 0.95417 ± 0.00902 | 0.85292 ± 0.00656 | 0.87340 ± 0.01084 | 0.91087 ± 0.01092 | 0.92013 ± 0.00431 |
| parkinsons    | 0.91533 ± 0.02663 | 0.85095 ± 0.03620 | 0.90074 ± 0.03723 | 0.86839 ± 0.00760 | 0.78860 ± 0.02119 | 0.87159 ± 0.02783 | 0.88944 ± 0.00452 |

### Recall

|               | catboost          | decision_tree     | gbc               | knn               | lr                | mlp               | svm               |
|---------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|
| balance       | 0.86427 ± 0.01213 | 0.75520 ± 0.01660 | 0.87787 ± 0.01011 | 0.71040 ± 0.03378 | 0.78213 ± 0.03354 | 0.84000 ± 0.03718 | 0.79493 ± 0.03243 |
| breast-cancer | 0.95936 ± 0.00767 | 0.92515 ± 0.01629 | 0.95643 ± 0.00697 | 0.96491 ± 0.00000 | 0.97983 ± 0.00402 | 0.97280 ± 0.00472 | 0.96900 ± 0.00438 |
| breast-tissue | 0.79546 ± 0.04507 | 0.70151 ± 0.06394 | 0.71515 ± 0.04970 | 0.66364 ± 0.02227 | 0.71667 ± 0.06175 | 0.63333 ± 0.04830 | 0.65455 ± 0.04636 |
| connectionist | 0.78809 ± 0.01667 | 0.72857 ± 0.05309 | 0.79285 ± 0.01860 | 0.81349 ± 0.00887 | 0.66984 ± 0.00809 | 0.84047 ± 0.02053 | 0.78333 ± 0.01880 |
| frogs         | 0.99064 ± 0.00091 | 0.96859 ± 0.00443 | 0.97721 ± 0.00200 | 0.99305 ± 0.00000 | 0.94533 ± 0.00232 | 0.98745 ± 0.00194 | 0.98170 ± 0.00087 |
| heart_2cl     | 0.84444 ± 0.01889 | 0.74938 ± 0.04823 | 0.83457 ± 0.03853 | 0.72222 ± 0.00000 | 0.91563 ± 0.04422 | 0.89144 ± 0.05743 | 0.89660 ± 0.10057 |
| ionosphere    | 0.94554 ± 0.01011 | 0.86948 ± 0.03019 | 0.95211 ± 0.00861 | 0.83568 ± 0.00840 | 0.86291 ± 0.01087 | 0.90516 ± 0.01087 | 0.91737 ± 0.00479 |
| parkinsons    | 0.91453 ± 0.02593 | 0.85096 ± 0.03651 | 0.89915 ± 0.03306 | 0.87008 ± 0.00640 | 0.79145 ± 0.02065 | 0.87008 ± 0.02381 | 0.87008 ± 0.00640 |


## Baseline

### F1-score

#### balance


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |   0.88484  |         0.7924  | 0.84133 | 0.8448  | 0.83759 | 0.9158  | 0.87434 |
| instance-hardness-threshold |   0.732467 |         0.64487 | 0.65359 | 0.67266 | 0.70658 | 0.8015  | 0.63642 |
| smotenn                     |   0.82956  |         0.77699 | 0.82366 | 0.75771 | 0.73804 | 0.85375 | 0.83594 |
| svm-smote                   |   0.873075 |         0.78417 | 0.84997 | 0.7716  | 0.93397 | 0.94528 | 0.8798  |




#### breast-cancer


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.96491 |         0.94709 | 0.97362 | 0.93042 | 0.96507 | 0.97362 | 0.96491 |
| baseline                    |    0.96472 |         0.92982 | 0.95578 | 0.96472 | 0.98246 | 0.96491 | 0.96491 |
| instance-hardness-threshold |    0.92185 |         0.91367 | 0.91351 | 0.96491 | 0.95643 | 0.96507 | 0.93922 |
| kmean-smote                 |    0.96472 |         0.94709 | 0.95578 | 0.95603 | 0.98246 | 0.97362 | 0.96491 |
| smotenn                     |    0.95603 |         0.92945 | 0.95578 | 0.95624 | 0.97375 | 0.98246 | 0.96491 |
| svm-smote                   |    0.96491 |         0.9204  | 0.96491 | 0.939   | 0.97375 | 0.97375 | 0.96491 |




#### breast-tissue


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |    0.85584 |         0.68254 | 0.70899 | 0.68254 | 0.7197  | 0.6048  | 0.68773 |
| instance-hardness-threshold |    0.60191 |         0.66944 | 0.61818 | 0.67424 | 0.67338 | 0.68723 | 0.62879 |
| kmean-smote                 |    0.69769 |         0.65981 | 0.64618 | 0.60065 | 0.76429 | 0.72879 | 0.63709 |
| smotenn                     |    0.58929 |         0.33407 | 0.5     | 0.53896 | 0.38898 | 0.48889 | 0.39394 |
| svm-smote                   |    0.67601 |         0.62572 | 0.68709 | 0.63636 | 0.67496 | 0.56006 | 0.60029 |




#### connectionist


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |    0.80865 |         0.78388 | 0.7619  | 0.80865 | 0.66515 | 0.85649 | 0.78584 |
| instance-hardness-threshold |    0.68995 |         0.68995 | 0.73586 | 0.73586 | 0.6398  | 0.76082 | 0.7814  |
| kmean-smote                 |    0.80865 |         0.78388 | 0.80952 | 0.80865 | 0.66515 | 0.83305 | 0.7619  |
| smotenn                     |    0.71429 |         0.66204 | 0.71299 | 0.7586  | 0.71429 | 0.73765 | 0.80688 |
| svm-smote                   |    0.78535 |         0.75529 | 0.78535 | 0.83305 | 0.66515 | 0.85649 | 0.78584 |




#### ecoli


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.93977 |         0.9237  | 0.89589 | 0.88466 | 0.88654 | 0.89994 | 0.92563 |
| baseline                    |    0.93977 |         0.87613 | 0.89589 | 0.92563 | 0.83368 | 0.86695 | 0.95422 |
| instance-hardness-threshold |    0.88466 |         0.86901 | 0.85582 | 0.94118 | 0.89589 | 0.95538 | 0.91349 |
| kmean-smote                 |    0.93977 |         0.92563 | 0.92563 | 0.92563 | 0.88989 | 0.9237  | 0.93977 |
| smotenn                     |    0.92563 |         0.90966 | 0.90966 | 0.94118 | 0.89994 | 0.89994 | 0.93977 |
| svm-smote                   |    0.92563 |         0.90966 | 0.89812 | 0.91349 | 0.86005 | 0.89994 | 0.91349 |




#### heart_2cl


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.88889 |         0.81481 | 0.84613 | 0.60928 | 0.83598 | 0.83032 | 0.80887 |
| baseline                    |    0.81583 |         0.6629  | 0.76978 | 0.689   | 0.87901 | 0.86232 | 0.70599 |
| instance-hardness-threshold |    0.69755 |         0.6823  | 0.73251 | 0.52335 | 0.6617  | 0.71502 | 0.60517 |
| smotenn                     |    0.68149 |         0.71457 | 0.71562 | 0.50151 | 0.76595 | 0.78253 | 0.78253 |
| svm-smote                   |    0.88889 |         0.72663 | 0.83868 | 0.66394 | 0.82033 | 0.83032 | 0.82454 |




#### ionosphere


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.94309 |         0.84574 | 0.95707 | 0.8674  | 0.85386 | 0.91463 | 0.95754 |
| baseline                    |    0.94239 |         0.87263 | 0.95707 | 0.81814 | 0.85137 | 0.89847 | 0.91358 |
| instance-hardness-threshold |    0.91549 |         0.86179 | 0.90254 | 0.85137 | 0.84257 | 0.61215 | 0.95754 |
| kmean-smote                 |    0.92844 |         0.90183 | 0.95707 | 0.8674  | 0.83794 | 0.89982 | 0.91358 |
| smotenn                     |    0.84845 |         0.84046 | 0.82464 | 0.85137 | 0.86497 | 0.8674  | 0.94309 |
| svm-smote                   |    0.92844 |         0.85386 | 0.95707 | 0.83497 | 0.83794 | 0.89982 | 0.91358 |




#### parkinsons


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.92423 |         0.86951 | 0.94872 | 0.85503 | 0.82732 | 0.9217  | 0.87372 |
| baseline                    |    0.91818 |         0.81731 | 0.91818 | 0.86364 | 0.76511 | 0.88792 | 0.85551 |
| instance-hardness-threshold |    0.78331 |         0.75971 | 0.75971 | 0.73498 | 0.73498 | 0.73498 | 0.73498 |
| kmean-smote                 |    0.89345 |         0.91818 | 0.91818 | 0.89345 | 0.76511 | 0.91818 | 0.85551 |
| smotenn                     |    0.87372 |         0.79487 | 0.90027 | 0.85503 | 0.77799 | 0.87666 | 0.83    |
| svm-smote                   |    0.92423 |         0.9217  | 0.92423 | 0.80671 | 0.77799 | 0.90027 | 0.8504  |

### Precision

#### balance


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |    0.87981 |         0.82353 | 0.82761 | 0.84172 | 0.81589 | 0.94037 | 0.84057 |
| instance-hardness-threshold |    0.90532 |         0.89072 | 0.91737 | 0.91946 | 0.93404 | 0.91748 | 0.93194 |
| smotenn                     |    0.9122  |         0.80691 | 0.85163 | 0.91101 | 0.93538 | 0.94424 | 0.93171 |
| svm-smote                   |    0.86778 |         0.81864 | 0.83    | 0.82185 | 0.94694 | 0.94771 | 0.90353 |




#### breast-cancer


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.96491 |         0.94744 | 0.97371 | 0.93337 | 0.96586 | 0.97371 | 0.96491 |
| baseline                    |    0.96518 |         0.92982 | 0.95687 | 0.96518 | 0.98246 | 0.96491 | 0.96491 |
| instance-hardness-threshold |    0.92628 |         0.92915 | 0.92382 | 0.96491 | 0.9581  | 0.96586 | 0.94354 |
| kmean-smote                 |    0.96518 |         0.94744 | 0.95687 | 0.95607 | 0.98246 | 0.97371 | 0.96491 |
| smotenn                     |    0.95607 |         0.92969 | 0.95687 | 0.95651 | 0.97397 | 0.98246 | 0.96491 |
| svm-smote                   |    0.96491 |         0.92113 | 0.96491 | 0.94076 | 0.97397 | 0.97397 | 0.96491 |




#### breast-tissue


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |    0.87121 |         0.69318 | 0.72565 | 0.69697 | 0.73636 | 0.58182 | 0.67045 |
| instance-hardness-threshold |    0.61818 |         0.70455 | 0.65    | 0.72727 | 0.79545 | 0.79394 | 0.68182 |
| kmean-smote                 |    0.675   |         0.71591 | 0.64773 | 0.61364 | 0.85    | 0.81169 | 0.62045 |
| smotenn                     |    0.6     |         0.26526 | 0.52121 | 0.58636 | 0.50162 | 0.49351 | 0.50649 |
| svm-smote                   |    0.7     |         0.62955 | 0.75379 | 0.67652 | 0.70227 | 0.54773 | 0.59091 |




#### connectionist


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |    0.81151 |         0.80504 | 0.7619  | 0.81151 | 0.67593 | 0.85979 | 0.78685 |
| instance-hardness-threshold |    0.69652 |         0.69652 | 0.75518 | 0.75518 | 0.65546 | 0.77381 | 0.82399 |
| kmean-smote                 |    0.81151 |         0.80504 | 0.80952 | 0.81151 | 0.67593 | 0.83371 | 0.76537 |
| smotenn                     |    0.71429 |         0.66987 | 0.72487 | 0.76969 | 0.71753 | 0.7448  | 0.8196  |
| svm-smote                   |    0.78588 |         0.80952 | 0.78588 | 0.83371 | 0.67593 | 0.85979 | 0.78685 |




#### ecoli


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.94071 |         0.92629 | 0.89523 | 0.88876 | 0.89755 | 0.90687 | 0.92534 |
| baseline                    |    0.94071 |         0.87885 | 0.89523 | 0.92534 | 0.85588 | 0.89804 | 0.95829 |
| instance-hardness-threshold |    0.88876 |         0.87082 | 0.86039 | 0.94118 | 0.89523 | 0.95546 | 0.91712 |
| kmean-smote                 |    0.94071 |         0.92534 | 0.92534 | 0.92534 | 0.89811 | 0.92629 | 0.94071 |
| smotenn                     |    0.92534 |         0.90974 | 0.90974 | 0.94118 | 0.90687 | 0.90687 | 0.94071 |
| svm-smote                   |    0.92534 |         0.90974 | 0.89965 | 0.91712 | 0.88119 | 0.90687 | 0.91712 |




#### heart_2cl


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.88889 |         0.81481 | 0.84362 | 0.82376 | 0.83929 | 0.82803 | 0.83528 |
| baseline                    |    0.87509 |         0.68069 | 0.79158 | 0.66435 | 0.88619 | 0.86252 | 0.63409 |
| instance-hardness-threshold |    0.87356 |         0.80993 | 0.85032 | 0.85526 | 0.86858 | 0.87632 | 0.8622  |
| smotenn                     |    0.83842 |         0.79572 | 0.8196  | 0.85375 | 0.88593 | 0.88966 | 0.88966 |
| svm-smote                   |    0.88889 |         0.73148 | 0.84014 | 0.83469 | 0.8283  | 0.82803 | 0.84368 |




#### ionosphere


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.9442  |         0.84676 | 0.96033 | 0.88264 | 0.86326 | 0.91539 | 0.95776 |
| baseline                    |    0.94817 |         0.87239 | 0.96033 | 0.84926 | 0.87131 | 0.90617 | 0.91844 |
| instance-hardness-threshold |    0.91549 |         0.87674 | 0.90699 | 0.87131 | 0.84342 | 0.78605 | 0.95776 |
| kmean-smote                 |    0.93111 |         0.90264 | 0.96033 | 0.88264 | 0.85086 | 0.90188 | 0.91844 |
| smotenn                     |    0.88431 |         0.84555 | 0.83227 | 0.87131 | 0.89398 | 0.88264 | 0.9442  |
| svm-smote                   |    0.93111 |         0.86326 | 0.96033 | 0.8602  | 0.85086 | 0.90188 | 0.91844 |




#### parkinsons


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.92682 |         0.86866 | 0.94872 | 0.90385 | 0.84418 | 0.92194 | 0.87696 |
| baseline                    |    0.93029 |         0.81538 | 0.93029 | 0.87042 | 0.76211 | 0.90987 | 0.89065 |
| instance-hardness-threshold |    0.84554 |         0.83639 | 0.83639 | 0.86569 | 0.86569 | 0.86569 | 0.86569 |
| kmean-smote                 |    0.89599 |         0.93029 | 0.93029 | 0.89599 | 0.76211 | 0.93029 | 0.89065 |
| smotenn                     |    0.87696 |         0.79487 | 0.90836 | 0.90385 | 0.79586 | 0.8925  | 0.86645 |
| svm-smote                   |    0.92682 |         0.92194 | 0.92682 | 0.85549 | 0.79586 | 0.90836 | 0.85945 |

### Recall

#### balance


|                             |   catboost |   decision_tree |   gbc |   knn |    lr |   mlp |   svm |
|-----------------------------|------------|-----------------|-------|-------|-------|-------|-------|
| baseline                    |   0.896    |           0.768 | 0.856 | 0.848 | 0.872 | 0.936 | 0.912 |
| instance-hardness-threshold |   0.674667 |           0.552 | 0.56  | 0.584 | 0.624 | 0.752 | 0.544 |
| smotenn                     |   0.788    |           0.752 | 0.8   | 0.688 | 0.664 | 0.816 | 0.792 |
| svm-smote                   |   0.884    |           0.76  | 0.872 | 0.728 | 0.928 | 0.944 | 0.864 |




#### breast-cancer


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.96491 |         0.94737 | 0.97368 | 0.92982 | 0.96491 | 0.97368 | 0.96491 |
| baseline                    |    0.96491 |         0.92982 | 0.95614 | 0.96491 | 0.98246 | 0.96491 | 0.96491 |
| instance-hardness-threshold |    0.92105 |         0.91228 | 0.91228 | 0.96491 | 0.95614 | 0.96491 | 0.9386  |
| kmean-smote                 |    0.96491 |         0.94737 | 0.95614 | 0.95614 | 0.98246 | 0.97368 | 0.96491 |
| smotenn                     |    0.95614 |         0.92982 | 0.95614 | 0.95614 | 0.97368 | 0.98246 | 0.96491 |
| svm-smote                   |    0.96491 |         0.92105 | 0.96491 | 0.9386  | 0.97368 | 0.97368 | 0.96491 |




#### breast-tissue


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |    0.86364 |         0.68182 | 0.72727 | 0.68182 | 0.72727 | 0.63636 | 0.72727 |
| instance-hardness-threshold |    0.63636 |         0.68182 | 0.63636 | 0.68182 | 0.68182 | 0.68182 | 0.63636 |
| kmean-smote                 |    0.72727 |         0.68182 | 0.68182 | 0.63636 | 0.77273 | 0.72727 | 0.68182 |
| smotenn                     |    0.63636 |         0.45455 | 0.54545 | 0.59091 | 0.45455 | 0.54545 | 0.45455 |
| svm-smote                   |    0.68182 |         0.63636 | 0.68182 | 0.63636 | 0.68182 | 0.59091 | 0.63636 |




#### connectionist


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| baseline                    |    0.80952 |         0.78571 | 0.7619  | 0.80952 | 0.66667 | 0.85714 | 0.78571 |
| instance-hardness-threshold |    0.69048 |         0.69048 | 0.7381  | 0.7381  | 0.64286 | 0.7619  | 0.78571 |
| kmean-smote                 |    0.80952 |         0.78571 | 0.80952 | 0.80952 | 0.66667 | 0.83333 | 0.7619  |
| smotenn                     |    0.71429 |         0.66667 | 0.71429 | 0.7619  | 0.71429 | 0.7381  | 0.80952 |
| svm-smote                   |    0.78571 |         0.7619  | 0.78571 | 0.83333 | 0.66667 | 0.85714 | 0.78571 |




#### ecoli


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.94118 |         0.92647 | 0.89706 | 0.88235 | 0.88235 | 0.89706 | 0.92647 |
| baseline                    |    0.94118 |         0.88235 | 0.89706 | 0.92647 | 0.85294 | 0.88235 | 0.95588 |
| instance-hardness-threshold |    0.88235 |         0.86765 | 0.85294 | 0.94118 | 0.89706 | 0.95588 | 0.91176 |
| kmean-smote                 |    0.94118 |         0.92647 | 0.92647 | 0.92647 | 0.89706 | 0.92647 | 0.94118 |
| smotenn                     |    0.92647 |         0.91176 | 0.91176 | 0.94118 | 0.89706 | 0.89706 | 0.94118 |
| svm-smote                   |    0.92647 |         0.91176 | 0.89706 | 0.91176 | 0.85294 | 0.89706 | 0.91176 |




#### heart_2cl


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.88889 |         0.81481 | 0.85185 | 0.57407 | 0.83333 | 0.83333 | 0.7963  |
| baseline                    |    0.85185 |         0.64815 | 0.81481 | 0.72222 | 0.88889 | 0.87037 | 0.7963  |
| instance-hardness-threshold |    0.66667 |         0.64815 | 0.7037  | 0.5     | 0.62963 | 0.68519 | 0.57407 |
| smotenn                     |    0.64815 |         0.68519 | 0.68519 | 0.48148 | 0.74074 | 0.75926 | 0.75926 |
| svm-smote                   |    0.88889 |         0.72222 | 0.85185 | 0.62963 | 0.81481 | 0.83333 | 0.81481 |




#### ionosphere


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.94366 |         0.84507 | 0.95775 | 0.87324 | 0.85915 | 0.91549 | 0.95775 |
| baseline                    |    0.94366 |         0.87324 | 0.95775 | 0.83099 | 0.85915 | 0.90141 | 0.91549 |
| instance-hardness-threshold |    0.91549 |         0.85915 | 0.90141 | 0.85915 | 0.84507 | 0.61972 | 0.95775 |
| kmean-smote                 |    0.92958 |         0.90141 | 0.95775 | 0.87324 | 0.84507 | 0.90141 | 0.91549 |
| smotenn                     |    0.85915 |         0.84507 | 0.83099 | 0.85915 | 0.87324 | 0.87324 | 0.94366 |
| svm-smote                   |    0.92958 |         0.85915 | 0.95775 | 0.84507 | 0.84507 | 0.90141 | 0.91549 |




#### parkinsons


|                             |   catboost |   decision_tree |     gbc |     knn |      lr |     mlp |     svm |
|-----------------------------|------------|-----------------|---------|---------|---------|---------|---------|
| adasyn                      |    0.92308 |         0.87179 | 0.94872 | 0.84615 | 0.82051 | 0.92308 | 0.87179 |
| baseline                    |    0.92308 |         0.82051 | 0.92308 | 0.87179 | 0.76923 | 0.89744 | 0.87179 |
| instance-hardness-threshold |    0.76923 |         0.74359 | 0.74359 | 0.71795 | 0.71795 | 0.71795 | 0.71795 |
| kmean-smote                 |    0.89744 |         0.92308 | 0.92308 | 0.89744 | 0.76923 | 0.92308 | 0.87179 |
| smotenn                     |    0.87179 |         0.79487 | 0.89744 | 0.84615 | 0.76923 | 0.87179 | 0.82051 |
| svm-smote                   |    0.92308 |         0.92308 | 0.92308 | 0.79487 | 0.76923 | 0.89744 | 0.84615 |


## Checklist

### Dataset

- [x] Breast Cancer
- [x] Frogs MFCCs
- [x] Breast Tissue
- [x] Connectionist BenchMark
- [x] Ionosphere
- [x] Parkinsons
- [ ] Heart Training Subset ( Heart2CL? )
- [x] Balance

Other (not included in Hoang's repo)

- [x] Ecoli

### Classifier

- [x] SMV
- [x] Logistic Regression
- [x] MLP

Other:

- [x] KNN
- [x] Decision Tree
- [x] Gradient Boosting Classifier
- [x] CatBoost


## [IMPORTANT] Experiment procedure

### Validation method

- For `sklearn.model_selection.train_test_split`, set `random_state=1`, `stratify=y`.
- ...



## Commands

- Train a CVAE model to generate random samples from any class

```bash
    python -m modules.cvae.train --config <pth/to/config>
```

- CVAE oversampling experiment

```bash
    python -m modules.cvae --config <pth/to/config>
```

For sample of config file, see `config/dev.yaml`

- Reproduce all experiments

```bash
    make all
```

## Note/Questions
- **Breast tissues**: Is the baseline result trained on Scaled Dataset?
- **Heart 2CL dataset**: training on spectf.data as train and spectf.test as validation or concate and split later( as in Thu's [notebook](https://colab.research.google.com/drive/1zm-V7dIAE5F61NxAcNASD9WBR1YzJXcv?usp=sharing#scrollTo=8-kXWlmtl-OM)?)

- **MLP**: where is the code for implementations?

## Citations

```bibtex
{
}
```


## Resource

- [Notebook](https://colab.research.google.com/drive/1zm-V7dIAE5F61NxAcNASD9WBR1YzJXcv?usp=sharing#scrollTo=pvXSYmgVoP9D) handling dataset
- [Hoang's repo](https://github.com/Cavan1Ed1s0n/MissingData/)
